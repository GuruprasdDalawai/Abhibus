<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="./style.css" />
    <link rel="styleSheet" href="./user.css" />
    <link rel="styleSheet" href="./admin.css" />
    <script src="./disableBackButton.js"></script>
    <script src="./admin.js"></script>
    <title>Abhi bus</title>
  </head>
  <body>
    <header class="header">
      <div class="Wrapper">
        <div class="poppins-extrabold logoFontSize display-inlineblock">
          <span class="logColor">Abhi</span>bus
        </div>
        <div
          style="
            display: inline-block;
            /* background-color: yellow; */
            align-content: center;
            cursor: pointer;
            align-content: center;
            margin-top: 5px;
            margin-bottom: auto;
          "
          id="notificationDiv"
          onclick="ShowNoficationDetails()"
        >
          <sapn class="numbernotification" id="numbernotification"></sapn>
          <script>
            setInterval(() => {
              let list = JSON.parse(localStorage.getItem("adminNotification"));
              // alert(list.length);
              if (list.length > 0) {
                document.getElementById("numbernotification").innerHTML =
                  list.length;
              } else {
                document.getElementById("numbernotification").innerHTML = "";
              }
            }, 5000);
          </script>
          <span>
            <box-icon name="envelope" id="notoficationShow"></box-icon
          ></span>
        </div>

        <div class="float-right user-detail">
          <span
            class="float-right"
            style="color: red; cursor: pointer"
            onclick="adminLogout();"
            >Logout</span
          >
        </div>
      </div>
    </header>
    <main>
      <div id="serchdiv" class="search2">
        <div class="Wrapper displayLine" id>
          <div class="input-box">
            <input
              type="text"
              placeholder="Bybus no/ companyName"
              id="searchInput"
              onkeyup="searchkey()"
            />
          </div>
          <!-- <div class="input-box">
            <button type="submit" class="btn" onclick="searchBuses()">
              Search
            </button>
          </div> -->
          <div class="input-box">
            <button type="submit" class="btn" onclick="showBusForm()">
              Add bus
            </button>
          </div>
        </div>
      </div>

      <!-- <div id="showbuse" class="Wrapper addBus" onclick="showUpdateBusform()">
        <div>
          <span>VRL</span>
          <div>KA28HB6886</div>
        </div>
        <div>
          <span>Vijayapura</span>
          <span>24-05-2024</span>
          <span>20:45</span>
        </div>
        <div>
          <spen>Bengaluru</spen>
          <span>23-05-2024</span>
          <spen>06:45</spen>
        </div>
        <div class="">
          <span>₹800 </span>
          <span>3 seats Available</span>
        </div>
      </div> -->

      <div id="displayContiner"></div>
      <div id="addnewbus" class="addnewbus">
        <button class="clsoeBtn" id="RegClose" onclick="closeBusForm()">
          X
        </button>
        <h1>Add new Bus</h1>
        <form>
          <div>
            <div class="input-box">
              <span>Busno</span>
              <input type="text" placeholder="kA01GD0001" id="addbusNo" />
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbusNo_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
          <div>
            <div class="input-box">
              <span>Source</span>
              <select id="addbusSource" onchange="updateDestinationOptions()">
                <option value="">Select</option>
                <option value="Bengaluru">Bengaluru</option>
                <option value="Hyderabad">Hyderabad</option>
                <option value="Mumbai">Mumbai</option>
                <option value="Channai">Channai</option>
              </select>
              <!-- <input type="text" placeholder="Bengaluru" id="addbusSource" /> -->
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbusSource_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
          <div>
            <div class="input-box">
              <span>Destination </span>
              <select id="addbusDestination"></select>
              <!-- <input type="text" placeholder="Mysore" id="addbusDestination" /> -->
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbusDestination_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
          <div>
            <div class="input-box">
              <span>Depearture Time</span>
              <input type="datetime-local" id="addbusDepartureTime" />
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbusDepartureTime_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
          <div>
            <div class="input-box">
              <span>Arrival Time</span>
              <input type="datetime-local" id="addbusArrivalTime" />
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbusArrivalTime_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
          <div>
            <div class="input-box">
              <span>Seats</span>
              <input
                type="number"
                placeholder="22"
                value="42"
                id="addbusSeats"
                readonly
              />
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbusSeats_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
          <div>
            <div class="input-box">
              <span>Fare</span>
              <input type="number" placeholder="₹" id="addbusfare" />
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbusfare_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
          <div>
            <div class="input-box">
              <span>Name of company</span>
              <input
                type="text"
                placeholder="company name"
                id="addbuscompany"
              />
            </div>
            <div class="errorContainer">
              <sapn class="error" id="addbuscompany_err"
                >please check your phonenumber</sapn
              >
            </div>
          </div>
        </form>
        <div class="float-right">
          <div class="btn-group">
            <button class="btn" onclick="addNewBus()">AddBus</button>
          </div>
        </div>
      </div>
      <div id="update" class="addnewbus">
        <button
          class="clsoeBtn"
          id="updateClose"
          onclick="closeUpdateBusForm()"
        >
          X
        </button>
        <h1>Bus details</h1>
        <form>
          <div class="input-box">
            <span>Busno</span>
            <input type="text" placeholder="kA01GD0001" id="updateBusno" />
          </div>
          <div class="input-box">
            <span>Source</span>
            <input type="text" placeholder="Bengaluru" id="updateSource" />
          </div>
          <div class="input-box">
            <span>Destination </span>
            <input type="text" placeholder="Mysore" id="updateDeestination" />
          </div>
          <div class="input-box">
            <span>Departure Time</span>
            <input type="datetime-local" id="updateDeparuteTime" />
          </div>
          <div class="input-box">
            <span>Arrival Time</span>
            <input type="datetime-local" id="updateArrivalTime" />
          </div>
          <div class="input-box">
            <span>Seats</span>
            <input
              type="number"
              placeholder="42"
              value="42"
              id="updateSeat"
              readonly
            />
          </div>
          <div class="input-box">
            <span>Fare</span>
            <input type="number" placeholder="₹" id="updateFare" />
          </div>
          <div class="input-box">
            <span>comapany</span>
            <input type="text" placeholder="company" id="updateCompany" />
          </div>
        </form>
        <div class="float-right">
          <div class="btn-group">
            <button class="btn" id="updatebtn" onclick="updateBus(this)">
              Update
            </button>
            <button class="btn" id="deleteBtn" onclick="deleteBus(this)">
              DELETE
            </button>
          </div>
        </div>
      </div>
      <div class="notificationConatiner" id="notificationConatiner">
        <button
          class="containerclsoeBtn"
          id="updateClose"
          onclick="closeNotification()"
        >
          X
        </button>
        <div class="noficationcontent" id="addNotification">
          <table id="addNotificationTbl">
            <tr>
              <td>PNR</td>
              <td>Mobile</td>
              <td>seats</td>
              <td>Status</td>
            </tr>
          </table>
        </div>
      </div>
    </main>
    <footer></footer>

    <script>
      const addbusDepartureTime = document.getElementById(
        "addbusDepartureTime"
      );
      const addbusArrivalTime = document.getElementById("addbusArrivalTime");
      const today = new Date().toISOString().slice(0, 16); // Remove milliseconds
      addbusDepartureTime.min = today;
      addbusArrivalTime.min = today;

      // Event listener for departure time changes
      addbusDepartureTime.addEventListener("change", function () {
        const selectedDeparture = new Date(addbusDepartureTime.value);
        const minArrival = new Date(selectedDeparture.getTime() + 60000); // Add 1 minute
        addbusArrivalTime.min = minArrival.toISOString().slice(0, 16);
      });

      if (localStorage.getItem("isLogin") != "admin") {
        location.href = "index.html";
      }
    </script>
    <script src="./admin.js"></script>
  </body>
</html>
